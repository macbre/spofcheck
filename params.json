{"body":"With the increase in 3rd party widgets and modernization of web applications, Frontend Single Point Of Failure (SPOF) has \r\nbecome a critical focus point. Thanks to [Steve Souders](https://twitter.com/souders) for his \r\n[initial research](http://www.stevesouders.com/blog/2010/06/01/frontend-spof/) \r\non this topic, we now have a list of common patterns which causes SPOF. The awareness of Frontend SPOF has also increased \r\ntremendously among engineers, thanks to some of the recent blogs and [articles](http://calendar.perfplanet.com/2012/spof-bug/) \r\nemphasizing the importance of it.  \r\n\r\nThere are already a bunch of utilities and plugins out there which can detect possible SPOF vulnerabilities in a web application. \r\nThe most notable ones being [webpagetest.org](http://blog.patrickmeenan.com/2011/10/testing-for-frontend-spof.html), \r\n[SPOF-O-Matic](https://chrome.google.com/webstore/detail/spof-o-matic/plikhggfbplemddobondkeogomgoodeg?hl=en-US) chrome \r\nplugin and [YSlow 3PO](http://www.phpied.com/3po/) extension. At eBay we wanted to detect SPOF at a very early stage, during\r\nthe development cycle itself. This means an additional hook in our automated testing pipeline. The solution resulted in \r\ncreating a simple tool which works on our test URLs and produces SPOF alerts. The tool is **spofcheck**.\r\n\r\nspofcheck is a [Command Line Interface](http://en.wikipedia.org/wiki/Command-line_interface) (CLI) built in Node.js to detect \r\npossible Frontend SPOF for web pages. The output is generated in an XML format\r\nthat can be consumed and reported by [CI](http://en.wikipedia.org/wiki/Continuous_integration) jobs. The tool is integrated \r\nwith our secondary jobs, which run daily automation on a testing server where a development branch is deployed. In case of \r\na SPOF alert, engineers are notified and they act on it accordingly. This process ensures that SPOFs are contained within \r\nthe development cycle and do not sneak into staging or production. \r\n\r\nThanks to github projects [spof-o-matic](https://github.com/pmeenan/spof-o-matic) and [3po](https://github.com/stoyan/yslow), \r\na lot of the code logic has been re-used here. The design and packaging of the tool is based on [csslint](https://github.com/stubbornella/csslint), \r\nthanks to [Nicholas Zakas](https://twitter.com/slicknet) and [Nicole Sullivan](https://twitter.com/stubbornella).\r\n\r\n##The command line interface\r\nspofcheck provides a simple command line interface and runs on Node.js \r\n\r\nTo install spofcheck run the following\r\n\r\n    $ npm install -g spofcheck\r\n\r\nTo run spofcheck, use the following format\r\n\r\n    spofcheck [options]* [urls]*\r\n    \r\n    Options\r\n    --help | -h                       \t\t     Displays this information.\r\n    --format=<format> | -f <format>   \t\t     Indicate which format [junit-xml | spof-xml | text] to use for output.\r\n    --outputdir=<dir> | -o <dir>      \t\t     Outputs the spof results to this directory.\r\n    --rules=<rule[,rule]+> | -r <rule[,rule]+>   Indicate which rules to include.\r\n    --print | -p                      \t\t     Outputs the results in console, instead of saving to a file.\r\n    --quiet | -q                      \t\t     Keeps the console clear from logging.\r\n\r\nExample\r\n\r\n    $ spofcheck -f junit-xml -o /tests www.ebay.com www.amazon.com\r\n\r\n##Rules\r\nspofcheck by default runs with 5 rules (checks). The rules are maintained in the [rules.js](https://github.com/senthilp/spofcheck/blob/master/lib/rules.js) \r\nfile. New rules can be easily added by pushing entries to the [rules](https://github.com/senthilp/spofcheck/blob/master/lib/rules.js#L6) \r\narray or calling the spof api [registerRules](https://github.com/senthilp/spofcheck/blob/master/lib/engine.js#L142). The \r\ndefault rules come from Souder's original [list](http://www.stevesouders.com/blog/2010/06/01/frontend-spof/) outlined below\r\n \r\n1. `3rdparty-scripts` - Always load 3rd party external scripts asyncronously in a non-blocking pattern \r\n1. `application-js` - Load application JS in a non-blocking pattern or towards the end of page\r\n1. `fontface-stylesheet` - Try to inline @font-face style. Also make the font files compressed and cacheable\r\n1. `fontface-inline` - Make sure the fonts files are compressed, cached and small in size\r\n1. `fontface-inline-precede-script-IE` - Make sure inlined @font-face is not preceded by a SCRIPT tag, causes SPOF in IE\r\n\r\n##Output\r\nspofcheck run creates a file and writes results in one of the below formats\r\n* `junit-xml` - a format most ci servers can parse, the default format\r\n* `spof-xml` - an XML format that can be consumed by other utilities\r\n* `text` - a textual representation of the results\r\n\r\nThe format can be specified using the `--format` or `-f` option. For just printing results i.e. no file creation, use the \r\n`--print` or `-p` option\r\n\r\n##Testing\r\nCurrently tests are written for the Command Line Interface as a whole and not individual modules. The main test file is [spofcheck.js](https://github.com/senthilp/spofcheck/blob/master/tests/spofcheck.js) \r\nand uses the default Node.js [assert](https://npmjs.org/package/assert) module. To run the tests - clone the [repo](https://github.com/senthilp/spofcheck), \r\ninstall the package `$ npm install` and run\r\n\r\n    $ npm test\r\n\r\n##Issues\r\nHave a bug or a feature request? [Please open a new issue](https://github.com/senthilp/spofcheck/issues)\r\n\r\n##Authors\r\n**Senthil Padmanabhan** - [github](https://github.com/senthilp) | [twitter](https://twitter.com/senthil_hi)\r\n<br/>\r\n**Venkat Sundramurthy** - [github](https://github.com/vsundramurthy) | [twitter](https://twitter.com/vsundramurthy)\r\n\r\n##License \r\nCopyright (c) 2012 eBay Inc.\r\n\r\nReleased under the MIT License\r\nhttp://www.opensource.org/licenses/MIT\r\n","tagline":"Fighting Frontend SPOF at its root","google":"","note":"Don't delete this file! It's used internally to help with page regeneration.","name":"SPOFCheck"}